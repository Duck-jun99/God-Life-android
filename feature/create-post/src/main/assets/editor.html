<!DOCTYPE html>
<html>
<head>
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <style>
        #editor {
            height: 1000px;
            margin-bottom: 20px;
        }
        #html-output {
            white-space: pre-wrap;
            border: 1px solid #ccc;
            padding: 10px;
            margin-top: 20px;
            font-family: monospace;
        }
    </style>
</head>
<body>
<div id="editor"></div>
<button onclick="showHtml()">HTML 보기</button>
<pre id="html-output"></pre>
<script>
    var quill = new Quill('#editor', {
        modules: {
            toolbar: [
                ['bold'],
                ['italic'],
                [{ 'color': [] }],
                [{ size: ['small', false, 'large', 'huge'] }],
                ['image'],
                ['link']
            ]
        },
        theme: 'snow'
    });

    document.querySelector('.ql-image').addEventListener('click', function() {
        QuillInterface.openImagePicker();
    });

    function getHtml() {
        return quill.root.innerHTML;
    }

    function setHtml(html) {
        quill.root.innerHTML = html;
    }

    function insertImage(url) {
        var decodedUrl = decodeURIComponent(url);
        var range = quill.getSelection();
        quill.insertEmbed(range.index, 'image', decodedUrl);
    }

    function showHtml() {
        var htmlContent = getHtml();
        var escapedHtml = htmlContent
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#039;');
        document.getElementById('html-output').innerHTML = escapedHtml;
    }

    // 실시간으로 HTML 업데이트
    quill.on('text-change', function() {
        showHtml();
    });

    // 초기 HTML 표시
    showHtml();
</script>
</body>
</html>